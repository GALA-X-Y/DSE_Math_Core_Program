Lbl 0:?→D:If D=1:Then Goto 1:IfEnd:If D=3:Then Goto 3:IfEnd:Goto 2:Lbl 1:  
?→A:?→B:?→C:?→M:?→X:?→Y:(YB-CX)÷(MB-AX◢B⁻¹(C-AAns◢Goto 0:  
Lbl 2:?→A:?→B:?→X:?→Y:(Y-B)÷(X-A→M:If D=4:Then Goto 4:IfEnd:  
√((X-A)²+(Y-B)²)◢M◢Y-B◢A-X◢BX-AY◢Goto 0:  
Lbl 4:(A+X)÷2→A◢(B+Y)÷2→B◢-M⁻¹→M◢Goto 0:Lbl 3:?→A:?→B:?→M:B-MA→C◢Goto 0  
(219 Bytes)