Lbl 0:?→D:If D≥2:Then Goto 2:IfEnd:?→A:?→B:?→C:?→X:?→Y:?→M:  
AX◢BX+YA◢CX+BY+AM◢CY+BM◢CM◢Goto 0:Lbl 2:?→A:?→B:?→C:If D=3:Then Goto 3:IfEnd:  
(A²-B²-C²)÷[cos⁻¹]()(Ans◢Goto 0:Lbl 3:-2Bcos(C→X:B²-A²→Y:X²-4Y→M:(-X+√(M))÷2◢Goto 0  
(161 Bytes)